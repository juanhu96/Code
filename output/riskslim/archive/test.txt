/mnt/phd/jihu/opioid/Code/risk_test.py:36: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
/mnt/phd/jihu/opioid/Code/risk_test.py:532: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  FULL_filtered.rename(columns={'prescriber_yr_avg_days_quartile_binary': 'prescriber_yr_avg_days_median_binary',\
Setting tag: test_CV_median
Stage: test, Scenario: CV, Max Points: 5, Max Features: 10, C0: None, Balanced: False,    First: False, Upto180: False, Median: True, Feature Set: None, Essential Num: None, No Drug: False,     County Name: None, Setting Tag: test_CV_median
Start testing...
Start testing with Table2:
Intercept: -8

 - Condition: long_acting, Cutoff: 1, Score: 5
 - Condition: prescriber_yr_avg_days_quartile, Cutoff: 1, Score: 3
 - Condition: num_prior_prescriptions, Cutoff: 1, Score: 2
 - Condition: age, Cutoff: 30, Score: 2
 - Condition: pharmacy_yr_avg_days_quartile, Cutoff: 1, Score: 2
 - Condition: concurrent_MME, Cutoff: 75, Score: 1
/export/storage_cures/CURES/Processed/FULL_OPIOID_2019_INPUT.csv imported with shape (6409165, 127)
WARNING: Encoding quartile values to binary

608176 2203847
Feature: long_acting, Cutoff: 1
Feature: prescriber_yr_avg_days_quartile, Cutoff: 1
Should only be for Drug payment
Feature: num_prior_prescriptions, Cutoff: 1
Feature: age, Cutoff: 30
Feature: pharmacy_yr_avg_days_quartile, Cutoff: 1
Should only be for Drug payment
Feature: concurrent_MME, Cutoff: 75
Current working directory: /mnt/phd/jihu/opioid/Code
ROC information for riskSLIM saved to output/baseline/riskSLIM_roc_test_info_median.pkl, threshodls: [           inf 9.99088949e-01 9.97527377e-01 9.93307149e-01
 9.82013790e-01 9.52574127e-01 8.80797078e-01 7.31058579e-01
 5.00000000e-01 2.68941421e-01 1.19202922e-01 4.74258732e-02
 1.79862100e-02 6.69285092e-03 2.47262316e-03 9.11051194e-04
 3.35350130e-04] with optimal threshold: 0.2689414213699951
Calibration information for riskSLIM saved to output/baseline/riskSLIM_calibration_test_info_median.pkl
Test done!

                   Value
Accuracy           0.725
Recall             0.863
Precision          0.238
ROC AUC            0.849
PR AUC              0.32
Calibration error   0.09
        Prob  Num_presc       TN  ...  Observed Risk  Num_patients  Num_longterm
0   0.000335     298898   298748  ...       0.000502        298897           210
1   0.000911      14138    14111  ...       0.001910         14137            32
2   0.002473    1497019  1492483  ...       0.003030       1481882          5936
3   0.006693     135241   133810  ...       0.010581        133059          1464
4   0.017986    1186193  1165510  ...       0.017436       1010437         13409
5   0.047426     724264   686844  ...       0.051666        668210         34181
6   0.119203     349565   330493  ...       0.054559        276353         12739
7   0.268941    1133064        0  ...       0.157920        771679         89684
8   0.500000     276687        0  ...       0.211936        146583         20946
9   0.731059     554261        0  ...       0.320908        275640         61533
10  0.880797     135609        0  ...       0.471429         69005         23214
11  0.952574       6871        0  ...       0.173337          6451           968
12  0.982014      24053        0  ...       0.370972         16254          5021
13  0.993307      41120        0  ...       0.345963         21921          5713
14  0.997527       9946        0  ...       0.607983          6353          3207
15  0.999089      22236        0  ...       0.679034         10792          5729

[16 rows x 10 columns]
