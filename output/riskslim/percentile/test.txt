/mnt/phd/jihu/opioid/Code/risk_train.py:74: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _train_single_p3_f6_c01e-15_interceptub15_interceptlb5_single_featurenopatientzip_cutoffatmostone_group_essential1.0
Stage: train, Scenario: single, Max Points: 3, Max Features: 6, C0: 1e-15,        Intercept Upper Bound: 15, Intercept Lower Bound: 5, Balanced: False,            First: False, Upto180: False, Feature Set: nopatientzip, Cutoff Set: atmostone_group, Essential Num: 1.0, No Drug: False,                No Insurance: False, County Name: None, Setting Tag: _train_single_p3_f6_c01e-15_interceptub15_interceptlb5_single_featurenopatientzip_cutoffatmostone_group_essential1.0
Start single training, file saved with setting tag _train_single_p3_f6_c01e-15_interceptub15_interceptlb5_single_featurenopatientzip_cutoffatmostone_group_essential1.0

/export/storage_cures/CURES/Processed/FULL_OPIOID_2018_INPUT.csv imported with shape (6816028, 271)
FULL_2018_STUMPS_
Finished importing STUMPS, with shape (6438178, 214) and columns ['concurrent_MME25', 'concurrent_MME50', 'concurrent_MME75', 'concurrent_MME90', 'num_prescribers_past1802', 'num_prescribers_past1803', 'num_prescribers_past1804', 'num_prescribers_past1805', 'num_prescribers_past1806', 'num_pharmacies_past1802', 'num_pharmacies_past1803', 'num_pharmacies_past1804', 'num_pharmacies_past1805', 'num_pharmacies_past1806', 'concurrent_benzo1', 'days_supply3', 'days_supply5', 'days_supply7', 'days_supply10', 'days_supply14', 'daily_dose25', 'daily_dose50', 'daily_dose75', 'daily_dose90', 'num_prior_prescriptions1', 'diff_MME1', 'diff_days1', 'patient_gender', 'Hydrocodone', 'Oxycodone', 'Codeine', 'Morphine', 'HMFO', 'long_acting', 'CashCredit', 'Medicare', 'Medicaid', 'Other', 'CommercialIns', 'MilitaryIns', 'WorkersComp', 'IndianNation', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'patient_zip_yr_num_prescriptions_above50', 'patient_zip_yr_num_prescriptions_above55', 'patient_zip_yr_num_prescriptions_above60', 'patient_zip_yr_num_prescriptions_above65', 'patient_zip_yr_num_prescriptions_above70', 'patient_zip_yr_num_prescriptions_above75', 'patient_zip_yr_num_prescriptions_above80', 'patient_zip_yr_num_patients_above50', 'patient_zip_yr_num_patients_above55', 'patient_zip_yr_num_patients_above60', 'patient_zip_yr_num_patients_above65', 'patient_zip_yr_num_patients_above70', 'patient_zip_yr_num_patients_above75', 'patient_zip_yr_num_patients_above80', 'patient_zip_yr_num_pharmacies_above50', 'patient_zip_yr_num_pharmacies_above55', 'patient_zip_yr_num_pharmacies_above60', 'patient_zip_yr_num_pharmacies_above65', 'patient_zip_yr_num_pharmacies_above70', 'patient_zip_yr_num_pharmacies_above75', 'patient_zip_yr_num_pharmacies_above80', 'patient_zip_yr_avg_MME_above50', 'patient_zip_yr_avg_MME_above55', 'patient_zip_yr_avg_MME_above60', 'patient_zip_yr_avg_MME_above65', 'patient_zip_yr_avg_MME_above70', 'patient_zip_yr_avg_MME_above75', 'patient_zip_yr_avg_MME_above80', 'patient_zip_yr_avg_days_above50', 'patient_zip_yr_avg_days_above55', 'patient_zip_yr_avg_days_above60', 'patient_zip_yr_avg_days_above65', 'patient_zip_yr_avg_days_above70', 'patient_zip_yr_avg_days_above75', 'patient_zip_yr_avg_days_above80', 'patient_zip_yr_avg_quantity_above50', 'patient_zip_yr_avg_quantity_above55', 'patient_zip_yr_avg_quantity_above60', 'patient_zip_yr_avg_quantity_above65', 'patient_zip_yr_avg_quantity_above70', 'patient_zip_yr_avg_quantity_above75', 'patient_zip_yr_avg_quantity_above80', 'prescriber_yr_num_prescriptions_above50', 'prescriber_yr_num_prescriptions_above55', 'prescriber_yr_num_prescriptions_above60', 'prescriber_yr_num_prescriptions_above65', 'prescriber_yr_num_prescriptions_above70', 'prescriber_yr_num_prescriptions_above75', 'prescriber_yr_num_prescriptions_above80', 'prescriber_yr_num_patients_above50', 'prescriber_yr_num_patients_above55', 'prescriber_yr_num_patients_above60', 'prescriber_yr_num_patients_above65', 'prescriber_yr_num_patients_above70', 'prescriber_yr_num_patients_above75', 'prescriber_yr_num_patients_above80', 'prescriber_yr_num_pharmacies_above50', 'prescriber_yr_num_pharmacies_above55', 'prescriber_yr_num_pharmacies_above60', 'prescriber_yr_num_pharmacies_above65', 'prescriber_yr_num_pharmacies_above70', 'prescriber_yr_num_pharmacies_above75', 'prescriber_yr_num_pharmacies_above80', 'prescriber_yr_avg_MME_above50', 'prescriber_yr_avg_MME_above55', 'prescriber_yr_avg_MME_above60', 'prescriber_yr_avg_MME_above65', 'prescriber_yr_avg_MME_above70', 'prescriber_yr_avg_MME_above75', 'prescriber_yr_avg_MME_above80', 'prescriber_yr_avg_days_above50', 'prescriber_yr_avg_days_above55', 'prescriber_yr_avg_days_above60', 'prescriber_yr_avg_days_above65', 'prescriber_yr_avg_days_above70', 'prescriber_yr_avg_days_above75', 'prescriber_yr_avg_days_above80', 'prescriber_yr_avg_quantity_above50', 'prescriber_yr_avg_quantity_above55', 'prescriber_yr_avg_quantity_above60', 'prescriber_yr_avg_quantity_above65', 'prescriber_yr_avg_quantity_above70', 'prescriber_yr_avg_quantity_above75', 'prescriber_yr_avg_quantity_above80', 'pharmacy_yr_num_prescriptions_above50', 'pharmacy_yr_num_prescriptions_above55', 'pharmacy_yr_num_prescriptions_above60', 'pharmacy_yr_num_prescriptions_above65', 'pharmacy_yr_num_prescriptions_above70', 'pharmacy_yr_num_prescriptions_above75', 'pharmacy_yr_num_prescriptions_above80', 'pharmacy_yr_num_patients_above50', 'pharmacy_yr_num_patients_above55', 'pharmacy_yr_num_patients_above60', 'pharmacy_yr_num_patients_above65', 'pharmacy_yr_num_patients_above70', 'pharmacy_yr_num_patients_above75', 'pharmacy_yr_num_patients_above80', 'pharmacy_yr_num_prescribers_above50', 'pharmacy_yr_num_prescribers_above55', 'pharmacy_yr_num_prescribers_above60', 'pharmacy_yr_num_prescribers_above65', 'pharmacy_yr_num_prescribers_above70', 'pharmacy_yr_num_prescribers_above75', 'pharmacy_yr_num_prescribers_above80', 'pharmacy_yr_avg_MME_above50', 'pharmacy_yr_avg_MME_above55', 'pharmacy_yr_avg_MME_above60', 'pharmacy_yr_avg_MME_above65', 'pharmacy_yr_avg_MME_above70', 'pharmacy_yr_avg_MME_above75', 'pharmacy_yr_avg_MME_above80', 'pharmacy_yr_avg_days_above50', 'pharmacy_yr_avg_days_above55', 'pharmacy_yr_avg_days_above60', 'pharmacy_yr_avg_days_above65', 'pharmacy_yr_avg_days_above70', 'pharmacy_yr_avg_days_above75', 'pharmacy_yr_avg_days_above80', 'pharmacy_yr_avg_quantity_above50', 'pharmacy_yr_avg_quantity_above55', 'pharmacy_yr_avg_quantity_above60', 'pharmacy_yr_avg_quantity_above65', 'pharmacy_yr_avg_quantity_above70', 'pharmacy_yr_avg_quantity_above75', 'pharmacy_yr_avg_quantity_above80', 'zip_pop_density_above50', 'zip_pop_density_above55', 'zip_pop_density_above60', 'zip_pop_density_above65', 'zip_pop_density_above70', 'zip_pop_density_above75', 'zip_pop_density_above80', 'median_household_income_above50', 'median_household_income_above55', 'median_household_income_above60', 'median_household_income_above65', 'median_household_income_above70', 'median_household_income_above75', 'median_household_income_above80', 'family_poverty_pct_above50', 'family_poverty_pct_above55', 'family_poverty_pct_above60', 'family_poverty_pct_above65', 'family_poverty_pct_above70', 'family_poverty_pct_above75', 'family_poverty_pct_above80', 'unemployment_pct_above50', 'unemployment_pct_above55', 'unemployment_pct_above60', 'unemployment_pct_above65', 'unemployment_pct_above70', 'unemployment_pct_above75', 'unemployment_pct_above80', 'patient_zip_yr_num_prescriptions_per_pop_above50', 'patient_zip_yr_num_prescriptions_per_pop_above55', 'patient_zip_yr_num_prescriptions_per_pop_above60', 'patient_zip_yr_num_prescriptions_per_pop_above65', 'patient_zip_yr_num_prescriptions_per_pop_above70', 'patient_zip_yr_num_prescriptions_per_pop_above75', 'patient_zip_yr_num_prescriptions_per_pop_above80', 'patient_zip_yr_num_patients_per_pop_above50', 'patient_zip_yr_num_patients_per_pop_above55', 'patient_zip_yr_num_patients_per_pop_above60', 'patient_zip_yr_num_patients_per_pop_above65', 'patient_zip_yr_num_patients_per_pop_above70', 'patient_zip_yr_num_patients_per_pop_above75', 'patient_zip_yr_num_patients_per_pop_above80']
Filtered STUMPS with columns ['concurrent_MME90', 'num_prescribers_past1802', 'num_prescribers_past1803', 'num_prescribers_past1804', 'num_prescribers_past1805', 'num_prescribers_past1806', 'num_pharmacies_past1802', 'num_pharmacies_past1803', 'num_pharmacies_past1804', 'num_pharmacies_past1805', 'num_pharmacies_past1806', 'concurrent_benzo1', 'days_supply3', 'days_supply5', 'days_supply7', 'days_supply10', 'daily_dose25', 'daily_dose50', 'daily_dose75', 'daily_dose90', 'num_prior_prescriptions1', 'diff_MME1', 'diff_days1', 'patient_gender', 'Hydrocodone', 'Oxycodone', 'Codeine', 'Morphine', 'HMFO', 'long_acting', 'CashCredit', 'Medicare', 'Medicaid', 'Other', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'prescriber_yr_num_prescriptions_above50', 'prescriber_yr_num_prescriptions_above75', 'prescriber_yr_num_patients_above50', 'prescriber_yr_num_patients_above75', 'prescriber_yr_num_pharmacies_above50', 'prescriber_yr_num_pharmacies_above75', 'prescriber_yr_avg_MME_above50', 'prescriber_yr_avg_MME_above75', 'prescriber_yr_avg_days_above50', 'prescriber_yr_avg_days_above75', 'pharmacy_yr_num_prescriptions_above50', 'pharmacy_yr_num_prescriptions_above75', 'pharmacy_yr_num_patients_above50', 'pharmacy_yr_num_patients_above75', 'pharmacy_yr_num_prescribers_above50', 'pharmacy_yr_num_prescribers_above75', 'pharmacy_yr_avg_MME_above50', 'pharmacy_yr_avg_MME_above75', 'pharmacy_yr_avg_days_above50', 'pharmacy_yr_avg_days_above75', 'zip_pop_density_above50', 'zip_pop_density_above75', 'median_household_income_above50', 'median_household_income_above75', 'family_poverty_pct_above50', 'family_poverty_pct_above75', 'unemployment_pct_above50', 'unemployment_pct_above75']
Traceback (most recent call last):
  File "/mnt/phd/jihu/opioid/Code/risk_main.py", line 245, in <module>
    main(stage, scenario, max_points, max_features, c0, interceptub, interceptlb, balanced, first, upto180, feature_set, cutoff_set, essential_num, nodrug, noinsurance, county_name, table_name, stretch, exact, setting_tag)
  File "/mnt/phd/jihu/opioid/Code/risk_main.py", line 140, in main
    table = risk_train(scenario, 2018, max_points, max_features, c0, interceptub, interceptlb, weight, first, upto180, feature_set, cutoff_set, essential_num, nodrug, noinsurance, county_name, stretch, exact, setting_tag)
  File "/mnt/phd/jihu/opioid/Code/risk_train.py", line 83, in risk_train
    x, constraints = import_stumps(year, first, upto180, feature_set, cutoff_set, essential_num, nodrug, noinsurance)
TypeError: cannot unpack non-iterable NoneType object
