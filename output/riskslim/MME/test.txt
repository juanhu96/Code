/users/phd/jihu/anaconda3/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/users/phd/jihu/anaconda3/lib/python3.9/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.4' currently installed).
  from pandas.core import (
/mnt/phd/jihu/opioid/Code/risk_train.py:78: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _train_single_p3_f7_c01e-15_interceptub15_interceptlb5_single_median_featurenopatientzip_cutoffatmostone_group_essential1.0_exact_top
Stage: train, Scenario: single, Max Points: 3, Max Features: 7, C0: 1e-15,        Intercept Upper Bound: 15, Intercept Lower Bound: 5, Balanced: False,            First: False, Upto180: False, Median: True, Feature Set: nopatientzip, Cutoff Set: atmostone_group, Essential Num: 1.0, No Drug: False,                No Insurance: False, County Name: None, Setting Tag: _train_single_p3_f7_c01e-15_interceptub15_interceptlb5_single_median_featurenopatientzip_cutoffatmostone_group_essential1.0_exact_top
Start single training, file saved with setting tag _train_single_p3_f7_c01e-15_interceptub15_interceptlb5_single_median_featurenopatientzip_cutoffatmostone_group_essential1.0_exact_top

/export/storage_cures/CURES/Processed/FULL_OPIOID_2018_INPUT.csv imported with shape (6816028, 127)
FULL_2018_Explore_STUMPS_median_
Finished importing STUMPS, with shape (6309500, 182) and columns ['concurrent_MME10', 'concurrent_MME15', 'concurrent_MME20', 'concurrent_MME25', 'concurrent_MME30', 'concurrent_MME35', 'concurrent_MME40', 'concurrent_MME45', 'concurrent_MME50', 'concurrent_MME75', 'concurrent_MME100', 'concurrent_MME200', 'concurrent_MME300', 'num_prescribers_past1802', 'num_prescribers_past1803', 'num_prescribers_past1804', 'num_prescribers_past1805', 'num_prescribers_past1806', 'num_pharmacies_past1802', 'num_pharmacies_past1803', 'num_pharmacies_past1804', 'num_pharmacies_past1805', 'num_pharmacies_past1806', 'concurrent_benzo1', 'num_prior_prescriptions1', 'diff_MME1', 'diff_quantity1', 'diff_days1', 'age20', 'age30', 'age40', 'age50', 'age60', 'age70', 'age80', 'days_supply3', 'days_supply5', 'days_supply7', 'days_supply10', 'days_supply14', 'days_supply21', 'days_supply30', 'daily_dose3', 'daily_dose5', 'daily_dose7', 'daily_dose10', 'daily_dose15', 'daily_dose20', 'daily_dose25', 'daily_dose30', 'daily_dose35', 'daily_dose40', 'daily_dose45', 'daily_dose50', 'daily_dose75', 'daily_dose100', 'patient_zip_yr_avg_days3', 'patient_zip_yr_avg_days5', 'patient_zip_yr_avg_days7', 'patient_zip_yr_avg_days10', 'patient_zip_yr_avg_days14', 'patient_zip_yr_avg_days21', 'patient_zip_yr_avg_days25', 'patient_zip_yr_avg_days30', 'patient_zip_yr_avg_days60', 'patient_zip_yr_avg_quantity10', 'patient_zip_yr_avg_quantity15', 'patient_zip_yr_avg_quantity20', 'patient_zip_yr_avg_quantity25', 'patient_zip_yr_avg_quantity30', 'patient_zip_yr_avg_quantity35', 'patient_zip_yr_avg_quantity40', 'patient_zip_yr_avg_quantity45', 'patient_zip_yr_avg_quantity50', 'patient_zip_yr_avg_quantity75', 'patient_zip_yr_avg_quantity100', 'patient_zip_yr_avg_quantity200', 'patient_zip_yr_avg_quantity300', 'patient_zip_yr_avg_MME10', 'patient_zip_yr_avg_MME15', 'patient_zip_yr_avg_MME20', 'patient_zip_yr_avg_MME25', 'patient_zip_yr_avg_MME30', 'patient_zip_yr_avg_MME35', 'patient_zip_yr_avg_MME40', 'patient_zip_yr_avg_MME45', 'patient_zip_yr_avg_MME50', 'patient_zip_yr_avg_MME75', 'patient_zip_yr_avg_MME100', 'patient_zip_yr_avg_MME200', 'patient_zip_yr_avg_MME300', 'Codeine', 'Hydrocodone', 'Oxycodone', 'Morphine', 'HMFO', 'long_acting', 'Medicaid', 'CommercialIns', 'Medicare', 'CashCredit', 'MilitaryIns', 'WorkersComp', 'Other', 'IndianNation', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'patient_gender', 'patient_zip_yr_num_prescriptions_quartile_top', 'patient_zip_yr_num_patients_quartile_top', 'patient_zip_yr_num_pharmacies_quartile_top', 'patient_zip_yr_avg_MME_quartile_top', 'patient_zip_yr_avg_days_quartile_top', 'patient_zip_yr_avg_quantity_quartile_top', 'patient_zip_yr_num_prescriptions_per_pop_quartile_top', 'patient_zip_yr_num_patients_per_pop_quartile_top', 'prescriber_yr_num_prescriptions_quartile_top', 'prescriber_yr_num_patients_quartile_top', 'prescriber_yr_num_pharmacies_quartile_top', 'prescriber_yr_avg_MME_quartile_top', 'prescriber_yr_avg_days_quartile_top', 'prescriber_yr_avg_quantity_quartile_top', 'pharmacy_yr_num_prescriptions_quartile_top', 'pharmacy_yr_num_patients_quartile_top', 'pharmacy_yr_num_prescribers_quartile_top', 'pharmacy_yr_avg_MME_quartile_top', 'pharmacy_yr_avg_days_quartile_top', 'pharmacy_yr_avg_quantity_quartile_top', 'zip_pop_density_quartile_top', 'median_household_income_quartile_top', 'family_poverty_pct_quartile_top', 'unemployment_pct_quartile_top', 'patient_zip_yr_num_prescriptions_quartile_0.0', 'patient_zip_yr_num_prescriptions_quartile_1.0', 'patient_zip_yr_num_patients_quartile_0.0', 'patient_zip_yr_num_patients_quartile_1.0', 'patient_zip_yr_num_pharmacies_quartile_0.0', 'patient_zip_yr_num_pharmacies_quartile_1.0', 'patient_zip_yr_avg_MME_quartile_0.0', 'patient_zip_yr_avg_MME_quartile_1.0', 'patient_zip_yr_avg_days_quartile_0.0', 'patient_zip_yr_avg_days_quartile_1.0', 'patient_zip_yr_avg_quantity_quartile_0.0', 'patient_zip_yr_avg_quantity_quartile_1.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_0.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_1.0', 'patient_zip_yr_num_patients_per_pop_quartile_0.0', 'patient_zip_yr_num_patients_per_pop_quartile_1.0', 'prescriber_yr_num_prescriptions_quartile_0.0', 'prescriber_yr_num_prescriptions_quartile_1.0', 'prescriber_yr_num_patients_quartile_0.0', 'prescriber_yr_num_patients_quartile_1.0', 'prescriber_yr_num_pharmacies_quartile_0.0', 'prescriber_yr_num_pharmacies_quartile_1.0', 'prescriber_yr_avg_MME_quartile_0.0', 'prescriber_yr_avg_MME_quartile_1.0', 'prescriber_yr_avg_days_quartile_0.0', 'prescriber_yr_avg_days_quartile_1.0', 'prescriber_yr_avg_quantity_quartile_0.0', 'prescriber_yr_avg_quantity_quartile_1.0', 'pharmacy_yr_num_prescriptions_quartile_0.0', 'pharmacy_yr_num_prescriptions_quartile_1.0', 'pharmacy_yr_num_patients_quartile_0.0', 'pharmacy_yr_num_patients_quartile_1.0', 'pharmacy_yr_num_prescribers_quartile_0.0', 'pharmacy_yr_num_prescribers_quartile_1.0', 'pharmacy_yr_avg_MME_quartile_0.0', 'pharmacy_yr_avg_MME_quartile_1.0', 'pharmacy_yr_avg_days_quartile_0.0', 'pharmacy_yr_avg_days_quartile_1.0', 'pharmacy_yr_avg_quantity_quartile_0.0', 'pharmacy_yr_avg_quantity_quartile_1.0', 'zip_pop_density_quartile_0.0', 'zip_pop_density_quartile_1.0', 'median_household_income_quartile_0.0', 'median_household_income_quartile_1.0', 'family_poverty_pct_quartile_0.0', 'family_poverty_pct_quartile_1.0', 'unemployment_pct_quartile_0.0', 'unemployment_pct_quartile_1.0']
Filtered STUMPS with columns ['concurrent_MME10', 'concurrent_MME15', 'concurrent_MME20', 'concurrent_MME25', 'concurrent_MME30', 'concurrent_MME35', 'concurrent_MME40', 'concurrent_MME45', 'concurrent_MME50', 'concurrent_MME75', 'concurrent_MME100', 'num_prescribers_past1802', 'num_prescribers_past1803', 'num_prescribers_past1804', 'num_prescribers_past1805', 'num_prescribers_past1806', 'num_pharmacies_past1802', 'num_pharmacies_past1803', 'num_pharmacies_past1804', 'num_pharmacies_past1805', 'num_pharmacies_past1806', 'concurrent_benzo1', 'num_prior_prescriptions1', 'diff_MME1', 'diff_days1', 'days_supply3', 'days_supply5', 'days_supply7', 'days_supply10', 'daily_dose10', 'daily_dose15', 'daily_dose20', 'daily_dose25', 'daily_dose30', 'daily_dose35', 'daily_dose40', 'daily_dose45', 'daily_dose50', 'daily_dose75', 'daily_dose100', 'Codeine', 'Hydrocodone', 'Oxycodone', 'Morphine', 'HMFO', 'long_acting', 'Medicaid', 'Medicare', 'CashCredit', 'Other', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'patient_gender', 'prescriber_yr_num_prescriptions_quartile_top', 'prescriber_yr_num_patients_quartile_top', 'prescriber_yr_num_pharmacies_quartile_top', 'prescriber_yr_avg_MME_quartile_top', 'prescriber_yr_avg_days_quartile_top', 'pharmacy_yr_num_prescriptions_quartile_top', 'pharmacy_yr_num_patients_quartile_top', 'pharmacy_yr_num_prescribers_quartile_top', 'pharmacy_yr_avg_MME_quartile_top', 'pharmacy_yr_avg_days_quartile_top', 'zip_pop_density_quartile_top', 'median_household_income_quartile_top', 'family_poverty_pct_quartile_top', 'unemployment_pct_quartile_top', 'zip_pop_density_quartile_0.0', 'zip_pop_density_quartile_1.0', 'median_household_income_quartile_0.0', 'median_household_income_quartile_1.0', 'family_poverty_pct_quartile_0.0', 'family_poverty_pct_quartile_1.0', 'unemployment_pct_quartile_0.0', 'unemployment_pct_quartile_1.0']
Traceback (most recent call last):
  File "/mnt/phd/jihu/opioid/Code/risk_main.py", line 249, in <module>
    main(stage, scenario, max_points, max_features, c0, interceptub, interceptlb, balanced, first, upto180, median, feature_set, cutoff_set, essential_num, nodrug, noinsurance, county_name, table_name, stretch, exact, top, setting_tag)
  File "/mnt/phd/jihu/opioid/Code/risk_main.py", line 144, in main
    table = risk_train(scenario, 2018, max_points, max_features, c0, interceptub, interceptlb, weight, first, upto180, median, feature_set, cutoff_set, essential_num, nodrug, noinsurance, county_name, stretch, exact, top, setting_tag)
  File "/mnt/phd/jihu/opioid/Code/risk_train.py", line 101, in risk_train
    x, constraints = import_stumps(year, case, first, upto180, median, feature_set, cutoff_set, essential_num, nodrug, noinsurance, top)
TypeError: cannot unpack non-iterable NoneType object
