/mnt/phd/jihu/opioid/Code/risk_test.py:40: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _test_CV_first_countyModoc
Stage: test, Scenario: CV, Max Points: 5, Max Features: 10, C0: None,        Intercept Upper Bound: None, Intercept Lower Bound: None, Balanced: False,            First: True, Upto180: False, Feature Set: None, Cutoff Set: None, Essential Num: None, No Drug: False,                No Insurance: False, County Name: Modoc, Setting Tag: _test_CV_first_countyModoc
Start testing...
Start testing with LTOUR_6:
Intercept: -5

 - Condition: days_supply, Cutoff: 10, Score: 2
 - Condition: num_prior_prescriptions, Cutoff: 1, Score: 2
 - Condition: daily_dose, Cutoff: 90, Score: 1
 - Condition: HMFO, Cutoff: 1, Score: 1
 - Condition: long_acting, Cutoff: 1, Score: 1
 - Condition: prescriber_yr_avg_days_above75, Cutoff: 1, Score: 1
Setting tag: _LTOUR_6_countyModoc_first

/export/storage_cures/CURES/Processed/FULL_OPIOID_2019_INPUT.csv imported with shape (6409165, 151)
Subsetting dataset to first prescription only with (3635072, 151) prescriptions.
Subsetting dataset to county Modoc with 690 prescriptions.
Test reults are saved with setting tag: _LTOUR_6_countyModoc_first_2019
Current working directory: /mnt/phd/jihu/opioid/Code
ROC information for riskSLIM saved to output/baseline/files/riskSLIM_roc_test_info_LTOUR_6_countyModoc_first_2019.pkl, threshodls: [       inf 0.5        0.26894142 0.11920292 0.04742587 0.01798621
 0.00669285] with optimal threshold: 0.11920292202211755
Calibration information for riskSLIM saved to output/baseline/files/riskSLIM_calibration_test_info_LTOUR_6_countyModoc_first_2019.pkl
Test done!

                   Value
Accuracy           0.845
Recall             0.824
Precision          0.452
ROC AUC            0.873
PR AUC             0.452
Calibration error  0.084
       Prob  Num_presc   TN  ...  Observed Risk  Num_patients  Num_longterm
0  0.006693        376  371  ...       0.013298           376             8
1  0.017986         97   91  ...       0.061856            97             7
2  0.047426         51   46  ...       0.098039            51             7
3  0.119203        135    0  ...       0.437037           135            63
4  0.268941         24    0  ...       0.416667            24            10
5  0.500000          7    0  ...       0.857143             7             6

[6 rows x 10 columns]
