/mnt/phd/jihu/opioid/Code/risk_test.py:40: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _test_CV_first_countySan Diego
Stage: test, Scenario: CV, Max Points: 5, Max Features: 10, C0: None,        Intercept Upper Bound: None, Intercept Lower Bound: None, Balanced: False,            First: True, Upto180: False, Feature Set: None, Cutoff Set: None, Essential Num: None, No Drug: False,                No Insurance: False, County Name: San Diego, Setting Tag: _test_CV_first_countySan Diego
Start testing...
Start testing with LTOUR_6:
Intercept: -5

 - Condition: days_supply, Cutoff: 10, Score: 2
 - Condition: num_prior_prescriptions, Cutoff: 1, Score: 2
 - Condition: daily_dose, Cutoff: 90, Score: 1
 - Condition: HMFO, Cutoff: 1, Score: 1
 - Condition: long_acting, Cutoff: 1, Score: 1
 - Condition: prescriber_yr_avg_days_above75, Cutoff: 1, Score: 1
Setting tag: _LTOUR_6_countySan Diego_first

/export/storage_cures/CURES/Processed/FULL_OPIOID_2019_INPUT.csv imported with shape (6409165, 151)
Subsetting dataset to first prescription only with (3635072, 151) prescriptions.
Subsetting dataset to county San Diego with 282139 prescriptions.
Test reults are saved with setting tag: _LTOUR_6_countySan Diego_first_2019
Current working directory: /mnt/phd/jihu/opioid/Code
ROC information for riskSLIM saved to output/baseline/files/riskSLIM_roc_test_info_LTOUR_6_countySan Diego_first_2019.pkl, threshodls: [       inf 0.88079708 0.73105858 0.5        0.26894142 0.11920292
 0.04742587 0.01798621 0.00669285] with optimal threshold: 0.04742587317756678
Calibration information for riskSLIM saved to output/baseline/files/riskSLIM_calibration_test_info_LTOUR_6_countySan Diego_first_2019.pkl
Test done!

                   Value
Accuracy           0.889
Recall             0.779
Precision          0.132
ROC AUC             0.88
PR AUC             0.187
Calibration error  0.007
       Prob  Num_presc      TN  ...  Observed Risk  Num_patients  Num_longterm
0  0.006693     219499  218716  ...       0.003567        219499          1109
1  0.017986      28014   27500  ...       0.018348         28014           676
2  0.047426      17507       0  ...       0.049295         17507          1039
3  0.119203      15122       0  ...       0.196336         15122          3335
4  0.268941       1534       0  ...       0.348110          1534           561
5  0.500000        419       0  ...       0.417661           419           182
6  0.731059         41       0  ...       0.536585            41            22
7  0.880797          3       0  ...       0.666667             3             2

[8 rows x 10 columns]
