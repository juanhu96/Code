/mnt/phd/jihu/opioid/Code/risk_test.py:40: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _test_CV_first_countyMadera
Stage: test, Scenario: CV, Max Points: 5, Max Features: 10, C0: None,        Intercept Upper Bound: None, Intercept Lower Bound: None, Balanced: False,            First: True, Upto180: False, Feature Set: None, Cutoff Set: None, Essential Num: None, No Drug: False,                No Insurance: False, County Name: Madera, Setting Tag: _test_CV_first_countyMadera
Start testing...
Start testing with LTOUR_6:
Intercept: -5

 - Condition: days_supply, Cutoff: 10, Score: 2
 - Condition: num_prior_prescriptions, Cutoff: 1, Score: 2
 - Condition: daily_dose, Cutoff: 90, Score: 1
 - Condition: HMFO, Cutoff: 1, Score: 1
 - Condition: long_acting, Cutoff: 1, Score: 1
 - Condition: prescriber_yr_avg_days_above75, Cutoff: 1, Score: 1
Setting tag: _LTOUR_6_countyMadera_first

/export/storage_cures/CURES/Processed/FULL_OPIOID_2019_INPUT.csv imported with shape (6409165, 151)
Subsetting dataset to first prescription only with (3635072, 151) prescriptions.
Subsetting dataset to county Madera with 13596 prescriptions.
Test reults are saved with setting tag: _LTOUR_6_countyMadera_first_2019
Current working directory: /mnt/phd/jihu/opioid/Code
ROC information for riskSLIM saved to output/baseline/files/riskSLIM_roc_test_info_LTOUR_6_countyMadera_first_2019.pkl, threshodls: [       inf 0.88079708 0.73105858 0.5        0.26894142 0.11920292
 0.04742587 0.01798621 0.00669285] with optimal threshold: 0.04742587317756678
Calibration information for riskSLIM saved to output/baseline/files/riskSLIM_calibration_test_info_LTOUR_6_countyMadera_first_2019.pkl
Test done!

                   Value
Accuracy           0.874
Recall             0.819
Precision          0.192
ROC AUC            0.891
PR AUC             0.253
Calibration error  0.016
       Prob  Num_presc     TN  ...  Observed Risk  Num_patients  Num_longterm
0  0.006693      10519  10468  ...       0.004848         10519            70
1  0.017986       1068   1034  ...       0.031835          1068            40
2  0.047426        859      0  ...       0.072177           859            72
3  0.119203       1025      0  ...       0.262439          1025           301
4  0.268941         76      0  ...       0.381579            76            30
5  0.500000         47      0  ...       0.510638            47            26
6  0.731059          1      0  ...       1.000000             1             1
7  0.880797          1      0  ...       0.000000             1             0

[8 rows x 10 columns]
