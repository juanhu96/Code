/mnt/phd/jihu/opioid/Code/risk_test.py:40: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _test_CV_first_countySan Bernardino
Stage: test, Scenario: CV, Max Points: 5, Max Features: 10, C0: None,        Intercept Upper Bound: None, Intercept Lower Bound: None, Balanced: False,            First: True, Upto180: False, Feature Set: None, Cutoff Set: None, Essential Num: None, No Drug: False,                No Insurance: False, County Name: San Bernardino, Setting Tag: _test_CV_first_countySan Bernardino
Start testing...
Start testing with LTOUR_6:
Intercept: -5

 - Condition: days_supply, Cutoff: 10, Score: 2
 - Condition: num_prior_prescriptions, Cutoff: 1, Score: 2
 - Condition: daily_dose, Cutoff: 90, Score: 1
 - Condition: HMFO, Cutoff: 1, Score: 1
 - Condition: long_acting, Cutoff: 1, Score: 1
 - Condition: prescriber_yr_avg_days_above75, Cutoff: 1, Score: 1
Setting tag: _LTOUR_6_countySan Bernardino_first

/export/storage_cures/CURES/Processed/FULL_OPIOID_2019_INPUT.csv imported with shape (6409165, 151)
Subsetting dataset to first prescription only with (3635072, 151) prescriptions.
Subsetting dataset to county San Bernardino with 172826 prescriptions.
Test reults are saved with setting tag: _LTOUR_6_countySan Bernardino_first_2019
Current working directory: /mnt/phd/jihu/opioid/Code
ROC information for riskSLIM saved to output/baseline/files/riskSLIM_roc_test_info_LTOUR_6_countySan Bernardino_first_2019.pkl, threshodls: [       inf 0.88079708 0.73105858 0.5        0.26894142 0.11920292
 0.04742587 0.01798621 0.00669285] with optimal threshold: 0.04742587317756678
Calibration information for riskSLIM saved to output/baseline/files/riskSLIM_calibration_test_info_LTOUR_6_countySan Bernardino_first_2019.pkl
Test done!

                   Value
Accuracy           0.853
Recall              0.83
Precision          0.202
ROC AUC            0.887
PR AUC             0.259
Calibration error   0.02
       Prob  Num_presc      TN  ...  Observed Risk  Num_patients  Num_longterm
0  0.006693     125641  124930  ...       0.005659        125641          1048
1  0.017986      16960   16417  ...       0.032017         16960           706
2  0.047426      12030       0  ...       0.062012         12030           871
3  0.119203      16580       0  ...       0.285163         16580          5191
4  0.268941       1225       0  ...       0.381224          1225           496
5  0.500000        356       0  ...       0.438202           356           159
6  0.731059         32       0  ...       0.437500            32            14
7  0.880797          2       0  ...       0.000000             2             0

[8 rows x 10 columns]
