/mnt/phd/jihu/opioid/Code/risk_test.py:40: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _test_CV_first_countyGlenn
Stage: test, Scenario: CV, Max Points: 5, Max Features: 10, C0: None,        Intercept Upper Bound: None, Intercept Lower Bound: None, Balanced: False,            First: True, Upto180: False, Feature Set: None, Cutoff Set: None, Essential Num: None, No Drug: False,                No Insurance: False, County Name: Glenn, Setting Tag: _test_CV_first_countyGlenn
Start testing...
Start testing with LTOUR_6:
Intercept: -5

 - Condition: days_supply, Cutoff: 10, Score: 2
 - Condition: num_prior_prescriptions, Cutoff: 1, Score: 2
 - Condition: daily_dose, Cutoff: 90, Score: 1
 - Condition: HMFO, Cutoff: 1, Score: 1
 - Condition: long_acting, Cutoff: 1, Score: 1
 - Condition: prescriber_yr_avg_days_above75, Cutoff: 1, Score: 1
Setting tag: _LTOUR_6_countyGlenn_first

/export/storage_cures/CURES/Processed/FULL_OPIOID_2019_INPUT.csv imported with shape (6409165, 151)
Subsetting dataset to first prescription only with (3635072, 151) prescriptions.
Subsetting dataset to county Glenn with 2838 prescriptions.
Test reults are saved with setting tag: _LTOUR_6_countyGlenn_first_2019
Current working directory: /mnt/phd/jihu/opioid/Code
ROC information for riskSLIM saved to output/baseline/files/riskSLIM_roc_test_info_LTOUR_6_countyGlenn_first_2019.pkl, threshodls: [       inf 0.73105858 0.5        0.26894142 0.11920292 0.04742587
 0.01798621 0.00669285] with optimal threshold: 0.04742587317756678
Calibration information for riskSLIM saved to output/baseline/files/riskSLIM_calibration_test_info_LTOUR_6_countyGlenn_first_2019.pkl
Test done!

                   Value
Accuracy           0.829
Recall             0.893
Precision          0.222
ROC AUC            0.892
PR AUC             0.266
Calibration error  0.028
       Prob  Num_presc    TN  ...  Observed Risk  Num_patients  Num_longterm
0  0.006693       1966  1956  ...       0.005086          1966            19
1  0.017986        269   263  ...       0.022305           269            10
2  0.047426        204     0  ...       0.098039           204            23
3  0.119203        371     0  ...       0.274933           371           109
4  0.268941         22     0  ...       0.500000            22            12
5  0.500000          5     0  ...       0.200000             5             1
6  0.731059          1     0  ...       0.000000             1             0

[7 rows x 10 columns]
