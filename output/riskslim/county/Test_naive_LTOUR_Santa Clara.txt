/mnt/phd/jihu/opioid/Code/risk_test.py:40: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Setting tag: _test_CV_first_countySanta Clara
Stage: test, Scenario: CV, Max Points: 5, Max Features: 10, C0: None,        Intercept Upper Bound: None, Intercept Lower Bound: None, Balanced: False,            First: True, Upto180: False, Feature Set: None, Cutoff Set: None, Essential Num: None, No Drug: False,                No Insurance: False, County Name: Santa Clara, Setting Tag: _test_CV_first_countySanta Clara
Start testing...
Start testing with LTOUR_6:
Intercept: -5

 - Condition: days_supply, Cutoff: 10, Score: 2
 - Condition: num_prior_prescriptions, Cutoff: 1, Score: 2
 - Condition: daily_dose, Cutoff: 90, Score: 1
 - Condition: HMFO, Cutoff: 1, Score: 1
 - Condition: long_acting, Cutoff: 1, Score: 1
 - Condition: prescriber_yr_avg_days_above75, Cutoff: 1, Score: 1
Setting tag: _LTOUR_6_countySanta Clara_first

/export/storage_cures/CURES/Processed/FULL_OPIOID_2019_INPUT.csv imported with shape (6409165, 151)
Subsetting dataset to first prescription only with (3635072, 151) prescriptions.
Subsetting dataset to county Santa Clara with 139350 prescriptions.
Test reults are saved with setting tag: _LTOUR_6_countySanta Clara_first_2019
Current working directory: /mnt/phd/jihu/opioid/Code
ROC information for riskSLIM saved to output/baseline/files/riskSLIM_roc_test_info_LTOUR_6_countySanta Clara_first_2019.pkl, threshodls: [       inf 0.95257413 0.73105858 0.5        0.26894142 0.11920292
 0.04742587 0.01798621 0.00669285] with optimal threshold: 0.01798620996209156
Calibration information for riskSLIM saved to output/baseline/files/riskSLIM_calibration_test_info_LTOUR_6_countySanta Clara_first_2019.pkl
Test done!

                   Value
Accuracy           0.836
Recall             0.827
Precision          0.058
ROC AUC            0.865
PR AUC             0.115
Calibration error  0.005
       Prob  Num_presc      TN  ...  Observed Risk  Num_patients  Num_longterm
0  0.006693     115407  115116  ...       0.002522        115407           423
1  0.017986       8537       0  ...       0.012065          8537           144
2  0.047426       9584       0  ...       0.044136          9584           496
3  0.119203       5186       0  ...       0.136329          5186           787
4  0.268941        500       0  ...       0.228000           500           123
5  0.500000        128       0  ...       0.351562           128            45
6  0.731059          7       0  ...       0.142857             7             1
7  0.952574          1       0  ...       0.000000             1             0

[8 rows x 10 columns]
