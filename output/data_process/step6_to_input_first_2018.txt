/mnt/phd/jihu/opioid/Code/sh script/../src/process/step6_to_input.py:19: DtypeWarning: Columns (4,85) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(f"{datadir}FULL_OPIOID_{year}_FEATURE.csv")
/mnt/phd/jihu/opioid/Code/sh script/../src/process/step6_to_input.py:27: DtypeWarning: Columns (4) have mixed types. Specify dtype option on import or set low_memory=False.
  RAW = pd.read_csv(f"{datadir}../RX_{year}.csv")
/mnt/phd/jihu/opioid/Code/sh script/../src/process/step6_to_input.py:35: DtypeWarning: Columns (4) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL_PREVIOUS = pd.read_csv(f"{datadir}../RX_{previous_year}.csv")
/users/phd/jihu/anaconda3/lib/python3.9/site-packages/numpy/lib/function_base.py:4486: RuntimeWarning: invalid value encountered in subtract
  diff_b_a = subtract(b, a)
/users/phd/jihu/anaconda3/lib/python3.9/site-packages/numpy/lib/function_base.py:4486: RuntimeWarning: invalid value encountered in subtract
  diff_b_a = subtract(b, a)
Imported FULL_OPIOID_2018_FEATURE.csv, with shape (6816028, 134), columns ['X', 'patient_id', 'patient_birth_year', 'patient_gender', 'patient_zip', 'prescriber_id', 'prescriber_zip', 'pharmacy_id', 'pharmacy_zip', 'strength', 'quantity', 'days_supply', 'date_filled', 'PRODUCTNDC', 'PROPRIETARYNAME', 'LABELERNAME', 'ROUTENAME', 'DEASCHEDULE', 'MAINDOSE', 'drx_refill_number', 'drx_refill_authorized_number', 'quantity_per_day', 'conversion', 'class', 'drug', 'daily_dose', 'total_dose', 'payment', 'num_prescriptions', 'prescription_id', 'age', 'concurrent_MME', 'concurrent_methadone_MME', 'num_prescribers_past180', 'num_pharmacies_past180', 'overlap', 'consecutive_days', 'concurrent_benzo', 'concurrent_benzo_same', 'concurrent_benzo_diff', 'alert1', 'alert2', 'alert3', 'alert4', 'alert5', 'alert6', 'num_alert', 'any_alert', 'presc_until', 'overlap_lt', 'opioid_days', 'long_term', 'days_to_long_term', 'long_term_180', 'num_prior_prescriptions', 'num_prior_prescriptions_past180', 'num_prior_prescriptions_past90', 'num_prior_prescriptions_past30', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'dose_diff', 'concurrent_MME_diff', 'quantity_diff', 'days_diff', 'avgMME_past180', 'avgDays_past180', 'avgMME_past90', 'avgDays_past90', 'avgMME_past30', 'avgDays_past30', 'gap', 'HMFO', 'Codeine_MME', 'Hydrocodone_MME', 'Oxycodone_MME', 'Morphine_MME', 'Hydromorphone_MME', 'Methadone_MME', 'Fentanyl_MME', 'Oxymorphone_MME', 'num_prior_prescriptions_benzo_past180', 'num_prior_prescriptions_benzo_past90', 'num_prior_prescriptions_benzo_past30', 'period_start', 'patient_HPIQuartile', 'prescriber_HPIQuartile', 'pharmacy_HPIQuartile', 'city_name', 'zip_pop', 'zip_pop_density', 'median_household_income', 'family_poverty_pct', 'unemployment_pct', 'patient_zip_yr_num_prescriptions', 'patient_zip_yr_num_patients', 'patient_zip_yr_num_pharmacies', 'patient_zip_yr_avg_MME', 'patient_zip_yr_avg_days', 'patient_zip_yr_avg_quantity', 'patient_zip_yr_num_prescriptions_quartile', 'patient_zip_yr_num_patients_quartile', 'patient_zip_yr_num_pharmacies_quartile', 'patient_zip_yr_avg_MME_quartile', 'patient_zip_yr_avg_days_quartile', 'patient_zip_yr_avg_quantity_quartile', 'prescriber_yr_num_prescriptions', 'prescriber_yr_num_patients', 'prescriber_yr_num_pharmacies', 'prescriber_yr_avg_MME', 'prescriber_yr_avg_days', 'prescriber_yr_avg_quantity', 'prescriber_yr_num_prescriptions_quartile', 'prescriber_yr_num_patients_quartile', 'prescriber_yr_num_pharmacies_quartile', 'prescriber_yr_avg_MME_quartile', 'prescriber_yr_avg_days_quartile', 'prescriber_yr_avg_quantity_quartile', 'pharmacy_yr_num_prescriptions', 'pharmacy_yr_num_patients', 'pharmacy_yr_num_prescribers', 'pharmacy_yr_avg_MME', 'pharmacy_yr_avg_days', 'pharmacy_yr_avg_quantity', 'pharmacy_yr_num_prescriptions_quartile', 'pharmacy_yr_num_patients_quartile', 'pharmacy_yr_num_prescribers_quartile', 'pharmacy_yr_avg_MME_quartile', 'pharmacy_yr_avg_days_quartile', 'pharmacy_yr_avg_quantity_quartile', 'PRODUCTTYPENAME', 'DOSAGEFORMNAME', 'long_acting']
Imported RX_2018.csv, columns ['X', 'patient_id', 'patient_birth_year', 'patient_gender', 'patient_zip', 'prescriber_id', 'prescriber_zip', 'pharmacy_id', 'pharmacy_zip', 'strength', 'quantity', 'days_supply', 'date_filled', 'PRODUCTNDC', 'PROPRIETARYNAME', 'LABELERNAME', 'ROUTENAME', 'DEASCHEDULE', 'MAINDOSE', 'drx_refill_number', 'drx_refill_authorized_number', 'quantity_per_day', 'conversion', 'class', 'drug', 'daily_dose', 'total_dose', 'payment']
Empty DataFrame
Columns: [patient_id, patient_birth_year, date_filled]
Index: []
Chronic prescriptions removed. Number of prescriptions left: 6816028
4063897 4063897
6816028 4063897
