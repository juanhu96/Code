/mnt/phd/jihu/opioid/Code/sh script/../src/process/step1_filter_split_data.py:20: DtypeWarning: Columns (4) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL_CURRENT = pd.read_csv(f"{basedir}RX_{year}.csv")
/mnt/phd/jihu/opioid/Code/sh script/../src/process/step1_filter_split_data.py:21: DtypeWarning: Columns (4) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL_PREVIOUS = pd.read_csv(f"{basedir}RX_{previous_year}.csv")
Number of prescriptions in 2019: 37175510, Number of prescriptions in 2018: 33108449
['Unnamed: 0', 'patient_id', 'patient_birth_year', 'patient_gender', 'patient_zip', 'prescriber_id', 'prescriber_zip', 'pharmacy_id', 'pharmacy_zip', 'strength', 'quantity', 'days_supply', 'date_filled', 'PRODUCTNDC', 'PROPRIETARYNAME', 'LABELERNAME', 'ROUTENAME', 'DEASCHEDULE', 'MAINDOSE', 'drx_refill_number', 'drx_refill_authorized_number', 'quantity_per_day', 'conversion', 'class', 'drug', 'daily_dose', 'total_dose', 'payment']
Number of chronic patients removed: 1548327, Number of prescriptions left: 8486712
Outliers removed. Number of prescriptions left: 8387944
Illicit users removed. Number of prescriptions left: 8387430
Underage patients removed. Number of prescriptions left: 8197802
Duplicate rows removed. Number of prescriptions left: 6861809
ONE: 2627283, part1: 1055054, part2: 1051776, part3: 1057096, part4: 1070600
Number of prescriptions in Benzodiazepine: 11817172
Duplicate rows removed from Benzodiazepine. Number of prescriptions left: 9947930
