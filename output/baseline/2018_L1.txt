/mnt/phd/jihu/opioid/Code/baseline_main.py:41: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Baseline test with model L1

Finished importing STUMPS, with shape (9153648, 193)

54 features selected: ['(Intercept)', 'concurrent_MME20', 'concurrent_MME30', 'concurrent_MME40', 'concurrent_MME75', 'concurrent_MME100', 'num_prescribers_past1802', 'num_prescribers_past1803', 'num_pharmacies_past1802', 'concurrent_benzo1', 'num_prior_prescriptions1', 'diff_MME1', 'diff_days1', 'age30', 'age40', 'age50', 'age70', 'age80', 'Codeine', 'Hydrocodone', 'HMFO', 'Medicare', 'CashCredit', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'patient_HPIQuartile_1.0', 'patient_HPIQuartile_2.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_1.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_2.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_3.0', 'patient_zip_yr_num_patients_per_pop_quartile_1.0', 'patient_zip_yr_num_patients_per_pop_quartile_2.0', 'patient_zip_yr_num_patients_per_pop_quartile_4.0', 'prescriber_yr_num_prescriptions_quartile_3.0', 'prescriber_yr_num_patients_quartile_3.0', 'prescriber_yr_num_pharmacies_quartile_4.0', 'prescriber_yr_avg_MME_quartile_1.0', 'prescriber_yr_avg_days_quartile_1.0', 'prescriber_yr_avg_days_quartile_2.0', 'prescriber_yr_avg_days_quartile_4.0', 'pharmacy_yr_num_patients_quartile_3.0', 'pharmacy_yr_num_patients_quartile_4.0', 'pharmacy_yr_num_prescribers_quartile_3.0', 'pharmacy_yr_avg_MME_quartile_3.0', 'pharmacy_yr_avg_days_quartile_1.0', 'pharmacy_yr_avg_days_quartile_2.0', 'pharmacy_yr_avg_days_quartile_4.0', 'zip_pop_density_quartile_3.0', 'median_household_income_quartile_2.0', 'family_poverty_pct_quartile_1.0', 'family_poverty_pct_quartile_2.0', 'family_poverty_pct_quartile_3.0', 'unemployment_pct_quartile_2.0']
{'training_accuracy': 0.8405, 'training_recall': 0.6818488529014844, 'training_precision': 0.7560793116348672, 'training_roc_auc': 0.9077831073507445, 'training_pr_auc': 0.8075690017476299, 'training_calibration_error': 0.2251339040678898}
9.9 seconds
