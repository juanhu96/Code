/mnt/phd/jihu/opioid/Code/baseline_main.py:38: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Baseline test with model DecisionTree

Finished importing STUMPS, with shape (9396681, 201)

['(Intercept)', 'concurrent_MME10', 'concurrent_MME15', 'concurrent_MME20', 'concurrent_MME25', 'concurrent_MME30', 'concurrent_MME35', 'concurrent_MME40', 'concurrent_MME45', 'concurrent_MME50', 'concurrent_MME75', 'concurrent_MME100', 'concurrent_MME200', 'concurrent_MME300', 'num_prescribers_past1802', 'num_prescribers_past1803', 'num_pharmacies_past1802', 'num_pharmacies_past1803', 'concurrent_benzo1', 'num_prior_prescriptions1', 'diff_MME1', 'diff_days1', 'age30', 'age40', 'age50', 'age60', 'age70', 'age80', 'Codeine', 'Hydrocodone', 'Oxycodone', 'Morphine', 'HMFO', 'Medicaid', 'Medicare', 'CashCredit', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'patient_gender', 'patient_HPIQuartile_1.0', 'patient_HPIQuartile_2.0', 'patient_HPIQuartile_3.0', 'patient_HPIQuartile_4.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_1.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_2.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_3.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_4.0', 'patient_zip_yr_num_patients_per_pop_quartile_1.0', 'patient_zip_yr_num_patients_per_pop_quartile_2.0', 'patient_zip_yr_num_patients_per_pop_quartile_3.0', 'patient_zip_yr_num_patients_per_pop_quartile_4.0', 'prescriber_yr_num_prescriptions_quartile_1.0', 'prescriber_yr_num_prescriptions_quartile_2.0', 'prescriber_yr_num_prescriptions_quartile_3.0', 'prescriber_yr_num_prescriptions_quartile_4.0', 'prescriber_yr_num_patients_quartile_1.0', 'prescriber_yr_num_patients_quartile_2.0', 'prescriber_yr_num_patients_quartile_3.0', 'prescriber_yr_num_patients_quartile_4.0', 'prescriber_yr_num_pharmacies_quartile_1.0', 'prescriber_yr_num_pharmacies_quartile_2.0', 'prescriber_yr_num_pharmacies_quartile_3.0', 'prescriber_yr_num_pharmacies_quartile_4.0', 'prescriber_yr_avg_MME_quartile_1.0', 'prescriber_yr_avg_MME_quartile_2.0', 'prescriber_yr_avg_MME_quartile_3.0', 'prescriber_yr_avg_MME_quartile_4.0', 'prescriber_yr_avg_days_quartile_1.0', 'prescriber_yr_avg_days_quartile_2.0', 'prescriber_yr_avg_days_quartile_3.0', 'prescriber_yr_avg_days_quartile_4.0', 'pharmacy_yr_num_prescriptions_quartile_1.0', 'pharmacy_yr_num_prescriptions_quartile_2.0', 'pharmacy_yr_num_prescriptions_quartile_3.0', 'pharmacy_yr_num_prescriptions_quartile_4.0', 'pharmacy_yr_num_patients_quartile_1.0', 'pharmacy_yr_num_patients_quartile_2.0', 'pharmacy_yr_num_patients_quartile_3.0', 'pharmacy_yr_num_patients_quartile_4.0', 'pharmacy_yr_num_prescribers_quartile_1.0', 'pharmacy_yr_num_prescribers_quartile_2.0', 'pharmacy_yr_num_prescribers_quartile_3.0', 'pharmacy_yr_num_prescribers_quartile_4.0', 'pharmacy_yr_avg_MME_quartile_1.0', 'pharmacy_yr_avg_MME_quartile_2.0', 'pharmacy_yr_avg_MME_quartile_3.0', 'pharmacy_yr_avg_MME_quartile_4.0', 'pharmacy_yr_avg_days_quartile_1.0', 'pharmacy_yr_avg_days_quartile_2.0', 'pharmacy_yr_avg_days_quartile_3.0', 'pharmacy_yr_avg_days_quartile_4.0', 'zip_pop_density_quartile_1.0', 'zip_pop_density_quartile_2.0', 'zip_pop_density_quartile_3.0', 'zip_pop_density_quartile_4.0', 'median_household_income_quartile_1.0', 'median_household_income_quartile_2.0', 'median_household_income_quartile_3.0', 'median_household_income_quartile_4.0', 'family_poverty_pct_quartile_1.0', 'family_poverty_pct_quartile_2.0', 'family_poverty_pct_quartile_3.0', 'family_poverty_pct_quartile_4.0', 'unemployment_pct_quartile_1.0', 'unemployment_pct_quartile_2.0', 'unemployment_pct_quartile_3.0', 'unemployment_pct_quartile_4.0']
[{'Prob': 0.005862716922736819, 'Num_presc': 2714100, 'TN': 2698188, 'FP': 0, 'FN': 15912, 'TP': 0, 'Observed Risk': 0.005862716922736819}, {'Prob': 0.09725128266522279, 'Num_presc': 1102587, 'TN': 995359, 'FP': 0, 'FN': 107228, 'TP': 0, 'Observed Risk': 0.09725128266522279}, {'Prob': 0.0982774497822607, 'Num_presc': 929552, 'TN': 838198, 'FP': 0, 'FN': 91354, 'TP': 0, 'Observed Risk': 0.0982774497822607}, {'Prob': 0.24898125426799245, 'Num_presc': 493499, 'TN': 370627, 'FP': 0, 'FN': 122872, 'TP': 0, 'Observed Risk': 0.24898125426799245}, {'Prob': 0.33996474216152206, 'Num_presc': 563279, 'TN': 371784, 'FP': 0, 'FN': 191495, 'TP': 0, 'Observed Risk': 0.33996474216152206}, {'Prob': 0.37560107513496815, 'Num_presc': 216903, 'TN': 135434, 'FP': 0, 'FN': 81469, 'TP': 0, 'Observed Risk': 0.37560107513496815}, {'Prob': 0.3889952134941113, 'Num_presc': 1053378, 'TN': 643619, 'FP': 0, 'FN': 409759, 'TP': 0, 'Observed Risk': 0.3889952134941113}, {'Prob': 0.5627659961441926, 'Num_presc': 82473, 'TN': 0, 'FP': 36060, 'FN': 0, 'TP': 46413, 'Observed Risk': 0.5627659961441926}, {'Prob': 0.6293564681484564, 'Num_presc': 307646, 'TN': 0, 'FP': 114027, 'FN': 0, 'TP': 193619, 'Observed Risk': 0.6293564681484564}, {'Prob': 0.6308230067605041, 'Num_presc': 703202, 'TN': 0, 'FP': 259606, 'FN': 0, 'TP': 443596, 'Observed Risk': 0.6308230067605041}, {'Prob': 0.7639395222303236, 'Num_presc': 510204, 'TN': 0, 'FP': 120439, 'FN': 0, 'TP': 389765, 'Observed Risk': 0.7639395222303236}, {'Prob': 0.9061912210463731, 'Num_presc': 719858, 'TN': 0, 'FP': 67529, 'FN': 0, 'TP': 652329, 'Observed Risk': 0.9061912210463731}]
['concurrent_MME40', 'concurrent_MME75', 'num_prior_prescriptions1', 'diff_days1', 'prescriber_yr_avg_days_quartile_3.0', 'prescriber_yr_avg_days_quartile_4.0', 'pharmacy_yr_avg_days_quartile_1.0'] 7
{'test_accuracy': 0.8278381483845201, 'test_recall': 0.6284926384226737, 'test_precision': 0.7427626009142703, 'test_roc_auc': 0.8880552921953336, 'test_pr_auc': 0.7358188540329499, 'calibration_error': 0.0}
8909.4 seconds
