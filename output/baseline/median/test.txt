/mnt/phd/jihu/opioid/Code/baseline_main.py:80: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
============================================================ 
Baseline train with model DecisionTree

WARNING: Working on median stumps
Filtered columns: ['concurrent_MME10', 'concurrent_MME15', 'concurrent_MME20', 'concurrent_MME25', 'concurrent_MME30', 'concurrent_MME35', 'concurrent_MME40', 'concurrent_MME45', 'concurrent_MME50', 'concurrent_MME75', 'concurrent_MME100', 'concurrent_MME200', 'concurrent_MME300', 'num_prescribers_past1802', 'num_prescribers_past1803', 'num_prescribers_past1804', 'num_prescribers_past1805', 'num_prescribers_past1806', 'num_pharmacies_past1802', 'num_pharmacies_past1803', 'num_pharmacies_past1804', 'num_pharmacies_past1805', 'num_pharmacies_past1806', 'concurrent_benzo1', 'num_prior_prescriptions1', 'diff_MME1', 'diff_days1', 'age30', 'age40', 'age50', 'age60', 'age70', 'age80', 'days_supply3', 'days_supply5', 'days_supply7', 'days_supply10', 'days_supply14', 'days_supply21', 'days_supply30', 'Codeine', 'Hydrocodone', 'Oxycodone', 'Morphine', 'HMFO', 'long_acting', 'Medicaid', 'Medicare', 'CashCredit', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'patient_gender', 'patient_zip_yr_num_prescriptions_per_pop_quartile_0.0', 'patient_zip_yr_num_prescriptions_per_pop_quartile_1.0', 'patient_zip_yr_num_patients_per_pop_quartile_0.0', 'patient_zip_yr_num_patients_per_pop_quartile_1.0', 'prescriber_yr_num_prescriptions_quartile_0.0', 'prescriber_yr_num_prescriptions_quartile_1.0', 'prescriber_yr_num_patients_quartile_0.0', 'prescriber_yr_num_patients_quartile_1.0', 'prescriber_yr_num_pharmacies_quartile_0.0', 'prescriber_yr_num_pharmacies_quartile_1.0', 'prescriber_yr_avg_MME_quartile_0.0', 'prescriber_yr_avg_MME_quartile_1.0', 'prescriber_yr_avg_days_quartile_0.0', 'prescriber_yr_avg_days_quartile_1.0', 'pharmacy_yr_num_prescriptions_quartile_0.0', 'pharmacy_yr_num_prescriptions_quartile_1.0', 'pharmacy_yr_num_patients_quartile_0.0', 'pharmacy_yr_num_patients_quartile_1.0', 'pharmacy_yr_num_prescribers_quartile_0.0', 'pharmacy_yr_num_prescribers_quartile_1.0', 'pharmacy_yr_avg_MME_quartile_0.0', 'pharmacy_yr_avg_MME_quartile_1.0', 'pharmacy_yr_avg_days_quartile_0.0', 'pharmacy_yr_avg_days_quartile_1.0', 'zip_pop_density_quartile_0.0', 'zip_pop_density_quartile_1.0', 'median_household_income_quartile_0.0', 'median_household_income_quartile_1.0', 'family_poverty_pct_quartile_0.0', 'family_poverty_pct_quartile_1.0', 'unemployment_pct_quartile_0.0', 'unemployment_pct_quartile_1.0']
WARNING: Working on bracketed stumps
Final Columns: ['num_prescribers_past180_6_inf', 'num_pharmacies_past180_6_inf', 'concurrent_benzo1', 'num_prior_prescriptions1', 'diff_MME1', 'diff_days1', 'days_supply_30_inf', 'Codeine', 'Hydrocodone', 'Oxycodone', 'Morphine', 'HMFO', 'long_acting', 'Medicaid', 'Medicare', 'CashCredit', 'switch_drug', 'switch_payment', 'ever_switch_drug', 'ever_switch_payment', 'patient_gender', 'patient_zip_yr_num_prescriptions_per_pop_quartile_1.0', 'patient_zip_yr_num_patients_per_pop_quartile_1.0', 'prescriber_yr_num_prescriptions_quartile_1.0', 'prescriber_yr_num_patients_quartile_1.0', 'prescriber_yr_num_pharmacies_quartile_1.0', 'prescriber_yr_avg_MME_quartile_1.0', 'prescriber_yr_avg_days_quartile_1.0', 'pharmacy_yr_num_prescriptions_quartile_1.0', 'pharmacy_yr_num_patients_quartile_1.0', 'pharmacy_yr_num_prescribers_quartile_1.0', 'pharmacy_yr_avg_MME_quartile_1.0', 'pharmacy_yr_avg_days_quartile_1.0', 'zip_pop_density_quartile_1.0', 'median_household_income_quartile_1.0', 'family_poverty_pct_quartile_1.0', 'unemployment_pct_quartile_1.0', 'concurrent_MME_0_10', 'concurrent_MME_10_15', 'concurrent_MME_15_20', 'concurrent_MME_20_25', 'concurrent_MME_25_30', 'concurrent_MME_30_35', 'concurrent_MME_35_40', 'concurrent_MME_40_45', 'concurrent_MME_45_50', 'concurrent_MME_50_75', 'concurrent_MME_75_100', 'concurrent_MME_100_200', 'concurrent_MME_200_300', 'concurrent_MME_300_inf', 'age_0_30', 'age_30_40', 'age_40_50', 'age_50_60', 'age_60_70', 'age_70_80', 'age_80_inf', 'num_prescribers_past180_eq_2', 'num_prescribers_past180_eq_3', 'num_prescribers_past180_eq_4', 'num_prescribers_past180_eq_5', 'num_prescribers_past180_eq_1', 'num_pharmacies_past180_eq_2', 'num_pharmacies_past180_eq_3', 'num_pharmacies_past180_eq_4', 'num_pharmacies_past180_eq_5', 'num_pharmacies_past180_eq_1', 'days_supply_0_3', 'days_supply_3_5', 'days_supply_5_7', 'days_supply_7_10', 'days_supply_10_14', 'days_supply_14_21', 'days_supply_21_30']
   num_prescribers_past180_6_inf  num_pharmacies_past180_6_inf  \
0                            0.0                           0.0   
1                            0.0                           0.0   
2                            0.0                           0.0   
3                            0.0                           0.0   
4                            0.0                           0.0   

   concurrent_benzo1  num_prior_prescriptions1  diff_MME1  diff_days1  \
0                0.0                       0.0        0.0         0.0   
1                0.0                       0.0        0.0         0.0   
2                0.0                       0.0        0.0         0.0   
3                0.0                       0.0        0.0         0.0   
4                0.0                       0.0        0.0         0.0   

   days_supply_30_inf  Codeine  Hydrocodone  Oxycodone  Morphine  HMFO  \
0                 0.0        0            1          0         0     0   
1                 0.0        0            1          0         0     0   
2                 0.0        0            1          0         0     0   
3                 0.0        0            1          0         0     0   
4                 0.0        1            0          0         0     0   

   long_acting  Medicaid  Medicare  CashCredit  switch_drug  switch_payment  \
0            0         0         0           0            0               0   
1            0         0         0           0            0               0   
2            0         0         1           0            0               0   
3            0         0         0           0            0               0   
4            0         0         0           0            0               0   

   ever_switch_drug  ever_switch_payment  patient_gender  \
0                 0                    0               1   
1                 0                    0               1   
2                 0                    0               0   
3                 0                    0               1   
4                 0                    0               1   

   patient_zip_yr_num_prescriptions_per_pop_quartile_1.0  \
0                                                  0       
1                                                  0       
2                                                  1       
3                                                  0       
4                                                  1       

   patient_zip_yr_num_patients_per_pop_quartile_1.0  \
0                                                 0   
1                                                 0   
2                                                 0   
3                                                 1   
4                                                 1   

   prescriber_yr_num_prescriptions_quartile_1.0  \
0                                             1   
1                                             1   
2                                             1   
3                                             1   
4                                             1   

   prescriber_yr_num_patients_quartile_1.0  \
0                                        1   
1                                        1   
2                                        1   
3                                        1   
4                                        1   

   prescriber_yr_num_pharmacies_quartile_1.0  \
0                                          1   
1                                          1   
2                                          1   
3                                          1   
4                                          1   

   prescriber_yr_avg_MME_quartile_1.0  prescriber_yr_avg_days_quartile_1.0  \
0                                   0                                    0   
1                                   0                                    0   
2                                   1                                    1   
3                                   1                                    0   
4                                   0                                    0   

   pharmacy_yr_num_prescriptions_quartile_1.0  \
0                                           1   
1                                           0   
2                                           1   
3                                           1   
4                                           1   

   pharmacy_yr_num_patients_quartile_1.0  \
0                                      1   
1                                      1   
2                                      1   
3                                      1   
4                                      1   

   pharmacy_yr_num_prescribers_quartile_1.0  pharmacy_yr_avg_MME_quartile_1.0  \
0                                         1                                 0   
1                                         1                                 0   
2                                         1                                 1   
3                                         1                                 1   
4                                         1                                 1   

   pharmacy_yr_avg_days_quartile_1.0  zip_pop_density_quartile_1.0  \
0                                  0                             1   
1                                  0                             0   
2                                  0                             0   
3                                  0                             1   
4                                  1                             1   

   median_household_income_quartile_1.0  family_poverty_pct_quartile_1.0  \
0                                     0                                1   
1                                     1                                0   
2                                     0                                1   
3                                     1                                0   
4                                     0                                1   

   unemployment_pct_quartile_1.0  concurrent_MME_0_10  concurrent_MME_10_15  \
0                              1                    0                     0   
1                              0                    0                     0   
2                              1                    0                     0   
3                              0                    0                     0   
4                              1                    1                     0   

   concurrent_MME_15_20  concurrent_MME_20_25  concurrent_MME_25_30  \
0                     0                     0                     0   
1                     0                     0                     0   
2                     0                     0                     0   
3                     0                     1                     0   
4                     0                     0                     0   

   concurrent_MME_30_35  concurrent_MME_35_40  concurrent_MME_40_45  \
0                     1                     0                     0   
1                     1                     0                     0   
2                     0                     0                     1   
3                     0                     0                     0   
4                     0                     0                     0   

   concurrent_MME_45_50  concurrent_MME_50_75  concurrent_MME_75_100  \
0                     0                     0                      0   
1                     0                     0                      0   
2                     0                     0                      0   
3                     0                     0                      0   
4                     0                     0                      0   

   concurrent_MME_100_200  concurrent_MME_200_300  concurrent_MME_300_inf  \
0                       0                       0                       0   
1                       0                       0                       0   
2                       0                       0                       0   
3                       0                       0                       0   
4                       0                       0                       0   

   age_0_30  age_30_40  age_40_50  age_50_60  age_60_70  age_70_80  \
0         0          1          0          0          0          0   
1         0          0          1          0          0          0   
2         0          0          0          0          0          1   
3         0          1          0          0          0          0   
4         0          0          1          0          0          0   

   age_80_inf  num_prescribers_past180_eq_2  num_prescribers_past180_eq_3  \
0           0                             0                             0   
1           0                             0                             0   
2           0                             0                             0   
3           0                             0                             0   
4           0                             0                             0   

   num_prescribers_past180_eq_4  num_prescribers_past180_eq_5  \
0                             0                             0   
1                             0                             0   
2                             0                             0   
3                             0                             0   
4                             0                             0   

   num_prescribers_past180_eq_1  num_pharmacies_past180_eq_2  \
0                           1.0                            0   
1                           1.0                            0   
2                           1.0                            0   
3                           1.0                            0   
4                           1.0                            0   

   num_pharmacies_past180_eq_3  num_pharmacies_past180_eq_4  \
0                            0                            0   
1                            0                            0   
2                            0                            0   
3                            0                            0   
4                            0                            0   

   num_pharmacies_past180_eq_5  num_pharmacies_past180_eq_1  days_supply_0_3  \
0                            0                          1.0                1   
1                            0                          1.0                0   
2                            0                          1.0                1   
3                            0                          1.0                0   
4                            0                          1.0                0   

   days_supply_3_5  days_supply_5_7  days_supply_7_10  days_supply_10_14  \
0                0                0                 0                  0   
1                1                0                 0                  0   
2                0                0                 0                  0   
3                0                0                 1                  0   
4                0                0                 1                  0   

   days_supply_14_21  days_supply_21_30  
0                  0                  0  
1                  0                  0  
2                  0                  0  
3                  0                  0  
4                  0                  0  
Traceback (most recent call last):
  File "/mnt/phd/jihu/opioid/Code/baseline_main.py", line 548, in <module>
    baseline_main(model, setting_tag, first, upto180, sample, median, bracket)
  File "/mnt/phd/jihu/opioid/Code/baseline_main.py", line 47, in baseline_main
    best_model, filtered_columns = baseline_train(year, first, upto180, model, setting_tag=setting_tag, sample=sample, median=median, bracket=bracket)
TypeError: cannot unpack non-iterable NoneType object
