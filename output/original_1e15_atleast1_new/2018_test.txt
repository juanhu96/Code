/mnt/phd/jihu/opioid/Code/risk_test.py:34: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  FULL = pd.read_csv(file_path, delimiter=",", dtype={'concurrent_MME': float,
Start testing, file saved with setting tag _2018_test_all

{'intercept': -6, 'conditions': ['num_prior_prescriptions', 'prescriber_yr_avg_days_quartile', 'concurrent_MME', 'age', 'Medicaid', 'patient_HPIQuartile', 'pharmacy_yr_avg_days_quartile'], 'cutoffs': [1, '4', 40, 40, 1, '1', '4'], 'scores': [2, 2, 1, 1, 1, 1, 1]}
Calibration curve saved as Calibration_2018_test_all.pdf

Calibration curve saved as Calibration_2018_test_all_gender.pdf

Calibration curve saved as Calibration_2018_test_all_gender.pdf

ROC curve saved as ROC_2018_test_all_gender.pdf

1: Accuracy = 0.9004, ROC AUC = 0.8550, Calibration = 0.0167
0: Accuracy = 0.8955, ROC AUC = 0.8515, Calibration = 0.0187
----------------------------------------------------------------------------------------------------
Total prescriptions from true positive patients: 
 (412844, 122)
----------------------------------------------------------------------------------------------------
Proportion of LT users detected within a month: 0.4785994714018116
Test done!

                    Value
Accuracy           0.8983
Recall             0.3866
Precision          0.4773
ROC AUC            0.8535
PR AUC             0.3683
Calibration error  0.0176
       Prob  Num_presc       TN      FP      FN      TP  Accuracy  \
0  0.002473     532341   531185       0    1156       0    0.9978   
1  0.006693    1575625  1563901       0   11724       0    0.9926   
2  0.017986    1296304  1274551       0   21753       0    0.9832   
3  0.047426    1157079  1073573       0   83506       0    0.9278   
4  0.119203    1111738   962940       0  148798       0    0.8662   
5  0.268941     555132   414839       0  140293       0    0.7473   
6  0.500000     345614        0  200427       0  145187    0.4201   
7  0.731059     155762        0   69214       0   86548    0.5556   
8  0.880797      35280        0   11188       0   24092    0.6829   
9  0.952574       1136        0     259       0     877    0.7720   

   Observed Risk  Num_patients  Num_longterm  
0       0.002172        532341          1543  
1       0.007441       1575625         15529  
2       0.016781       1260221         22873  
3       0.072170        877612         48732  
4       0.133843        669438         64735  
5       0.252720        332070         64187  
6       0.420084        183109         57118  
7       0.555643         74064         32054  
8       0.682880         15742          8746  
9       0.772007           537           361  
